name: e2e
on: 
  push:
    branches:
      - master

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v3
      
    - name: Add custom host entry
      run: echo "127.0.0.1 to-dos.local.tourmalinecore.internal" | sudo tee -a /etc/hosts

    - name: Verify host entry
      run: cat /etc/hosts
      
    - name: Set up Docker
      uses: docker/setup-buildx-action@v3
      
    - name: Install kind
      uses: helm/kind-action@v1.5.0

    - name: Create cluster
      run: kind create cluster --name to-dos --config kind-local-config.yaml --kubeconfig ./.to-dos-cluster-kubeconfig
